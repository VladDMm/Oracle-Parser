// Parser.cpp : This file contains the 'main' function. Program execution begins and ends there.
//

#include <iostream>
#include "OracleParser.h"
//
int main()
{

	const char* src = R"SQL(
   SELECT first_name;                                                                                                                                    DECLARE x NUMBER := 100;                                                                                                                              BEGIN                                                                                                                                                 FOR i IN 1..10 LOOP                                                                                                                                   IF MOD(i,2) = 0 THEN                                                                                                                                  INSERT INTO temp VALUES (i, x, "i is even");                                                                                                          ELSE                                                                                                                                                  INSERT INTO temp VALUES (i, x, "i is odd");                                                                                                           END IF;                                                                                                                                               x := x + 100;                                                                                                                                         END LOOP;                                                                                                                                             COMMIT;                                                                                                                                               END;                                                                                                                                                  /  SELECT first_name;                                                                                                                                    DECLARE x NUMBER := 100;                                                                                                                              BEGIN                                                                                                                                                 FOR i IN 1..10 LOOP                                                                                                                                   IF MOD(i,2) = 0 THEN                                                                                                                                  INSERT INTO temp VALUES (i, x, "i is even");                                                                                                          ELSE                                                                                                                                                  INSERT INTO temp VALUES (i, x, "i is odd");                                                                                                           END IF;                                                                                                                                               x := x + 100;                                                                                                                                         END LOOP;                                                                                                                                             COMMIT;                                                                                                                                               END;          /                                                                                                                                        

select * from;
CREATE OR REPLACE TRIGGER %s.%s_SERIAL_TRG
BEFORE INSERT ON %s
FOR EACH ROW
BEGIN
SELECT %s_SERIAL_SEQ.nextval INTO :new.%s FROM dual;
END;/
SELECT first_name;                                                                                                                                    DECLARE x NUMBER := 100;                                                                                                                              BEGIN                                                                                                                                                 FOR i IN 1..10 LOOP                                                                                                                                   IF MOD(i,2) = 0 THEN                                                                                                                                  INSERT INTO temp VALUES (i, x, "i is even");                                                                                                          ELSE                                                                                                                                                  INSERT INTO temp VALUES (i, x, "i is odd");                                                                                                           END IF;                                                                                                                                               x := x + 100;                                                                                                                                         END LOOP;                                                                                                                                             COMMIT;                                                                                                                                               END;                                                                                                                                                  /  SELECT first_name;                                                                                                                                    DECLARE x NUMBER := 100;                                                                                                                              BEGIN                                                                                                                                                 FOR i IN 1..10 LOOP                                                                                                                                   IF MOD(i,2) = 0 THEN                                                                                                                                  INSERT INTO temp VALUES (i, x, "i is even");                                                                                                          ELSE                                                                                                                                                  INSERT INTO temp VALUES (i, x, "i is odd");                                                                                                           END IF;                                                                                                                                               x := x + 100;                                                                                                                                         END LOOP;                                                                                                                                             COMMIT;                                                                                                                                               END; /    
select * from;     
)SQL";
	char* stmts;
	OracleParser parser(src);
	auto stmt = parser.SplitOracleStatement();

	for (const auto& x : stmt)
	{
		std::cout << "-----------" << (x.type == StmtType::PLSQL ? "[PLSQL]" : "[SQL]") << "----------\n";
		std::cout << x.text << std::endl;
	}
}
